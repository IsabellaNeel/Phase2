<!DOCTYPE html>
<html lang="en">
    <head>
        <title>User Profile</title>
        <link rel="stylesheet" href="style.css" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap');
        </style>
        <script type="text/javascript" src="menu.js"></script>
    </head>

    <body ontouchstart = "">
        <div class = "navbar upper">
            <table class = "navcont" style = "font-size: 1.9rem">
                <tr style = "width: 100vw;">
                    <td style = "width: 5%"></td>
                    <td style = "width: 45%"><p style = "font-weight: bold !important; text-align: left !important">My profile</p></td>
                    <td style = "width: 38%"></td>
                    <td style = "width: 8%" class = "menuicon" onclick="toggleMenu();" id = "hamburger">&#8801;</td>
                    <td style = "width: 4%"></td>
                </tr>
            </table>
        </div>
        <div style = "height: 9.5vh">
            <!-- padding space -->
        </div>
        <div class="menu hide" id="menu">
            <table style="width: 100% !important;">
                <tr>
                    <td>
                        <br/><br/><br/><br/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <ul style = "padding-left: 5%">
                            <li class="menuitem" onclick="location.href='#putsomethinghere'">Search</li>
                            <li class="menuitem" onclick="location.href='#putsomethinghere'">Settings</li>
                        </ul>
                    </td>
                </tr>
            </table>
        </div>
        <!-- PUT PAGE CONTENT HERE -->


    <div class="profile-item-grid">
        <div class="profile-item-grid-item" style="text-align: center;">
            <img src="pfp.png" alt="" style="width:256px;height: 256px;">
            <div style="font-size: 40px;" id="name">Hello!</div>
            <div>
            <input type="text" id="nameInput" />
            <button onclick="update_name()" class="profile-updateinfo-button">Change Name</button>
            <input type="file" id="imgInput" />
            <button onclick="" class="profile-updateinfo-button">Change Picture</button>
            </div>
        </div>
        <div class="profile-item-grid-item">
            Allergens
            <p id="allergens" class="profile-text-content"></p>
            <div>
            <input type="text" id="AllergensInput" />
            <button onclick="update_allergens()" class="profile-updateinfo-button">Update Allergens</button>
            </div>
        </div>
        <div class="profile-item-grid-item">
            Preferences
            <p id="preferences" class="profile-text-content"></p>
            <div>
            <input type="text" id="preferencesInput" />
            <button onclick="update_preferences()" class="profile-updateinfo-button">Update Preferences</button>
            </div>
        </div>
        <div class="profile-item-grid-item">
            Skill Level
            <p id="skill" class="profile-text-content"></p>
            <div>
            <input type="text" id="skillInput" />
            <button onclick="update_skill()" class="profile-updateinfo-button">Update Skill Level</button>
            </div>
        </div>
        <div class="profile-item-grid-item">
            Notes
            <p id="notes" class="profile-text-content"></p>
            <div>
            <input type="text" id="notesInput" />
            <button onclick="update_notes()" class="profile-updateinfo-button">Update Notes</button>
            </div>
        </div>
        <div class="profile-item-grid-item">
            <button onclick="close_window()" class="profile-logout-button">Logout</button>
        </div>
    </div>

    <script type = "text/javascript">
        fill_info();
        function close_window() {
            if (confirm("Clear data?")) {
                clear_info("allergens")
                clear_info("name");
                clear_info("preferences");
                clear_info("skill");
                clear_info("notes")
                sessionStorage.clear();
            }
        }
        function update_name() {
            var get = document.getElementById("nameInput");
            if(get.value){
                // console.log(get.value);
                sessionStorage.setItem("name", get.value);
                fill_info()
            } else{
                clear_info("name");
            }
        }
        function update_allergens() {
            var get = document.getElementById("AllergensInput");
            if(get.value){
                // console.log(get.value);
                sessionStorage.setItem("allergens", get.value);
                fill_info()
            } else{
                clear_info("allergens");
            }
        }
        function update_preferences() {
            var get = document.getElementById("preferencesInput");
            if(get.value){
                // console.log(get.value);
                sessionStorage.setItem("preferences", get.value);
                fill_info()
            } else{
                clear_info("preferences");
            }
        }
        function update_skill() {
            var get = document.getElementById("skillInput");
            if(get.value){
                // console.log(get.value);
                sessionStorage.setItem("skill", get.value);
                fill_info()
            } else{
                clear_info("skill");
            }
        }
        function update_notes() {
            var get = document.getElementById("notesInput");
            if(get.value){
                // console.log(get.value);
                sessionStorage.setItem("notes", get.value);
                fill_info()
            } else{
                clear_info("notes");
            }
        }

        function fill_info(){
            if(sessionStorage.getItem("name")){
                document.getElementById("name").innerHTML = "Hello " + sessionStorage.getItem("name") + "!";
            }
            if(sessionStorage.getItem("allergens")){
                document.getElementById("allergens").innerHTML = sessionStorage.getItem("allergens");
            }
            if(sessionStorage.getItem("preferences")){
                document.getElementById("preferences").innerHTML = sessionStorage.getItem("preferences");
            }
            if(sessionStorage.getItem("skill")){
                document.getElementById("skill").innerHTML = sessionStorage.getItem("skill");
            }
            if(sessionStorage.getItem("notes")){
                document.getElementById("notes").innerHTML = sessionStorage.getItem("notes");
            }
        }
        function clear_info(input){
            if(sessionStorage.getItem(input)){
                document.getElementById(input).innerHTML = "";
                if(input=="name"){
                    document.getElementById("name").innerHTML = "Hello!";
                }
                sessionStorage.removeItem(input);
            }
        }
    </script>


        <div class = "navbar lower">
            <table class = "navcont">
                <tr style = "width: 100vw;">
                    <td style = "width: 5%"></td>
                    <td class = "navitem" onclick = "location.href='index.html'"><p>Kitchen</p></td>
                    <td class = "navitem" onclick = "location.href='RecipesTab.html'"><p>Recipes</p></td>
                    <td class = "navitem" onclick = "location.href='ShoppingListTab.html'"><p>Shopping</p></td>
                    <td class = "navitem selected"><p>Profile</p></td>
                    <td style = "width: 5%"></td>
                </tr>
            </table>
        </div>
    </body>
</html>
